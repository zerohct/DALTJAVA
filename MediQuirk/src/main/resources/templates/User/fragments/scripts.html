<div class="main-nav" th:fragment="scripts">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://kit.fontawesome.com/a076d05399.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>
    <!--    <script  th:src="@{~/js/user/app.js}"></script>-->
    <script>
        document.getElementById('toggle-password').addEventListener('click', function () {
        const passwordField = document.getElementById('password');
        const type = passwordField.getAttribute('type') === 'password' ? 'text' : 'password';
        passwordField.setAttribute('type', type);
        this.querySelector('i').classList.toggle('bi-eye');
        this.querySelector('i').classList.toggle('bi-eye-slash');
        });

        document.getElementById('toggle-confirm-password').addEventListener('click', function () {
        const confirmPasswordField = document.getElementById('confirmPassword');
        const type = confirmPasswordField.getAttribute('type') === 'password' ? 'text' : 'password';
        confirmPasswordField.setAttribute('type', type);
        this.querySelector('i').classList.toggle('bi-eye');
        this.querySelector('i').classList.toggle('bi-eye-slash');
        });
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const userMenu = document.getElementById('user-menu');
            const submenu = userMenu.querySelector('.submenu');
            let timeoutId;

            userMenu.addEventListener('mouseenter', function() {
                clearTimeout(timeoutId);
                submenu.style.display = 'block';
            });

            userMenu.addEventListener('mouseleave', function() {
                timeoutId = setTimeout(function() {
                    submenu.style.display = 'none';
                }, 300); // 300ms delay before hiding
            });

            submenu.addEventListener('mouseenter', function() {
                clearTimeout(timeoutId);
            });

            submenu.addEventListener('mouseleave', function() {
                submenu.style.display = 'none';
            });
        });
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const ratingInputs = document.querySelectorAll('.rating-input');
            const editButtons = document.querySelectorAll('.edit-review-btn');
            const cancelButtons = document.querySelectorAll('.cancel-edit-btn');

            function updateStars(container, value) {
                const stars = container.querySelectorAll('.star');
                stars.forEach((star, index) => {
                    if (index < value) {
                        star.classList.remove('bi-star');
                        star.classList.add('bi-star-fill');
                    } else {
                        star.classList.remove('bi-star-fill');
                        star.classList.add('bi-star');
                    }
                });
            }

            function setupStarRating(container) {
                const stars = container.querySelectorAll('.star');
                const ratingInput = container.querySelector('.rating-input');

                stars.forEach(star => {
                    star.addEventListener('click', function() {
                        const value = this.dataset.value;
                        ratingInput.value = value;
                        updateStars(container, value);
                    });
                });

                // Initialize stars
                updateStars(container, ratingInput.value);
            }

            // Setup star rating for all rating containers
            document.querySelectorAll('.rating-container').forEach(setupStarRating);

            // Update all review stars
            document.querySelectorAll('.review-content').forEach(reviewContent => {
                const ratingValue = parseInt(reviewContent.dataset.rating);
                updateStars(reviewContent, ratingValue);
            });

            editButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const reviewContent = this.closest('.review-content');
                    const editForm = reviewContent.nextElementSibling;
                    reviewContent.classList.add('hidden');
                    editForm.classList.remove('hidden');
                });
            });

            cancelButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const editForm = this.closest('.edit-review-form');
                    const reviewContent = editForm.previousElementSibling;
                    editForm.classList.add('hidden');
                    reviewContent.classList.remove('hidden');
                });
            });

            // Quantity incrementing and decrementing
            window.incrementQuantity = function() {
                var quantityInput = document.getElementById('quantity');
                quantityInput.value = parseInt(quantityInput.value) + 1;
            }

            window.decrementQuantity = function() {
                var quantityInput = document.getElementById('quantity');
                var currentValue = parseInt(quantityInput.value);
                if (currentValue > 1) {
                    quantityInput.value = currentValue - 1;
                }
            }
        });
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
        const editButtons = document.querySelectorAll('.edit-review-btn');
        const cancelButtons = document.querySelectorAll('.cancel-edit-btn');

        editButtons.forEach(button => {
            button.addEventListener('click', function() {
                const reviewContent = this.closest('.review-content');
                const editForm = reviewContent.nextElementSibling;
                reviewContent.classList.add('hidden');
                editForm.classList.remove('hidden');
            });
        });

        cancelButtons.forEach(button => {
            button.addEventListener('click', function() {
                const editForm = this.closest('.edit-review-form');
                const reviewContent = editForm.previousElementSibling;
                editForm.classList.add('hidden');
                reviewContent.classList.remove('hidden');
            });
        });
    });
    </script>

</div>